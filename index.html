<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Uplink Terminal v3.1</title>
    <style>
        :root {
            --bg: #0a0a0a;
            --card-bg: #111111;
            --accent: #00ff41;
            --border: #333;
            --text: #e0e0e0;
        }

        body { 
            background-color: var(--bg); 
            color: var(--text); 
            font-family: 'Courier New', Courier, monospace; 
            margin: 0; 
            display: flex; 
            justify-content: center; 
            align-items: center; 
            min-height: 100vh; 
        }

        .view-container { 
            display: none; 
            width: 100%; 
            max-width: 450px; 
            padding: 20px; 
            flex-direction: column; 
            animation: fadeIn 0.2s ease-out; 
        }

        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }

        .brutalist-card { 
            border: 2px solid var(--accent); 
            background-color: var(--card-bg); 
            padding: 1.5rem; 
            box-shadow: 6px 6px 0px rgba(0, 255, 65, 0.2); 
            box-sizing: border-box; 
            margin-bottom: 15px;
        }

        .terminal-header { 
            border-bottom: 2px solid var(--accent); 
            margin-bottom: 15px; 
            padding-bottom: 8px; 
            font-weight: bold; 
            color: var(--accent);
            text-transform: uppercase;
        }

        input, select { 
            width: 100%; 
            background: #000; 
            border: 1px solid var(--border); 
            color: var(--accent); 
            padding: 10px; 
            box-sizing: border-box; 
            outline: none;
            font-family: 'Courier New', monospace;
            margin-bottom: 10px;
        }

        .btn { 
            width: 100%; 
            padding: 12px; 
            background: var(--accent); 
            color: #000; 
            border: none; 
            font-weight: bold; 
            cursor: pointer; 
            text-transform: uppercase;
        }

        .btn:hover { background: #fff; }

        .countdown-num { font-size: 4rem; color: var(--accent); margin: 10px 0; text-align: center; }

        .loader-bar { width: 100%; height: 4px; background: #222; position: relative; overflow: hidden; }
        .loader-progress { width: 100%; height: 100%; background: var(--accent); position: absolute; left: -100%; }

        .skip-btn {
            background: transparent;
            border: 1px solid #444;
            color: #666;
            font-size: 0.6rem;
            margin-top: 20px;
            cursor: pointer;
            padding: 5px;
        }
        .skip-btn:hover { color: var(--accent); border-color: var(--accent); }

        .copy-hint { font-size: 0.7rem; color: var(--accent); margin-top: 5px; display: none; }
    </style>
</head>
<body>

    <div id="view-loading" class="view-container">
        <div class="brutalist-card" style="text-align: center;">
            <div class="terminal-header" style="text-align: left;">UPLINK_SEQUENCE</div>
            <div class="countdown-num" id="countdown">5</div>
            <div class="loader-bar"><div class="loader-progress" id="progress-bar"></div></div>
            <button class="skip-btn" onclick="setAutoSkip()">[ ENABLE_AUTO_BYPASS ]</button>
        </div>
    </div>

    <div id="view-login" class="view-container">
        <div class="brutalist-card">
            <div class="terminal-header">AUTH_REQUIRED</div>
            <input placeholder="OPERATOR_ID" type="text" id="adminUser">
            <input id="adminPass" placeholder="PASSWORD" type="password">
            <button class="btn" onclick="attemptLogin()">LOGIN</button>
        </div>
    </div>

    <div id="view-locked" class="view-container">
        <div class="brutalist-card">
            <div class="terminal-header">LOCKED_UPLINK</div>
            <input id="linkPass" placeholder="ACCESS_KEY" type="password">
            <button class="btn" onclick="checkLinkPassword()">DECRYPT</button>
        </div>
    </div>

    <div id="view-admin" class="view-container">
        <div class="terminal-header">LINK_CONSTRUCTOR</div>
        <div class="brutalist-card" style="border-style: dashed;">
            <input type="text" id="customRef" placeholder="Referral (e.g. TikTok)">
            <select id="redirectMode">
                <option value="timed">Timed (5s)</option>
                <option value="direct">Direct (Instant)</option>
            </select>
            <p style="font-size: 0.6rem; color: #888;">Select a link below to copy with these settings.</p>
        </div>
        <div id="admin-list"></div>
        <button class="btn" onclick="clearAutoSkip()" style="background: #e68a00; margin-top: 20px; margin-bottom: 10px;">RESET_BYPASS_STATE</button>
        <button class="btn" onclick="location.reload()" style="background: #ff4444;">LOGOUT</button>
    </div>

    <div id="view-404" class="view-container">
        <div class="brutalist-card">
            <div class="terminal-header">ERROR_404</div>
            <p>SIGNAL_LOST: CODE_INVALID</p>
            <button class="btn" onclick="window.location.search=''">RETRY</button>
        </div>
    </div>

    <script>
        //----------------------------------------------------------------------
        const G_CONFIG = {
            settings: {
                salt: "my_secret_salt_123",
                masterHash: "dc02833e8dba6d393d3f38f678612bbd688aacd85a98afbc95481c352dfefe02",
                hookA: "aHR0cHM6Ly9kaXNjb3JkLmNvbS9hcGkvd2ViaG9va3MvMTQxMDQ3NTA1NjY4NDk5MDYzNS9KcDFMeFBy", 
                hookB: "ZV9GVHlMUU9fVnFNa0piRGw5cWtxdXRZVC1mYTQ5T1FRLXlzNXdjVkhGbllsSEdrdVB3QTBIZjY1RHpveg=="
            },
            links: {
                'BUa8b2': { url: 'https://imgur.com/a/got-you-45Qpn5g', locked: false },
                'another': { url: 'https://github.com/another-example', locked: false },
                'BingTest': { url: 'https://www.bing.com', locked: true, hash: '578cf32c2d24552cbcf9c680cf9cdd4a077859b9fc6dfc126653d4b6e1ab146e' },
                'Voltsim': { url: 'https://discord.gg/AC8MhtVfF6', locked: false }
            }
        };
        //----------------------------------------------------------------------

        let activeLinkId = null;
        let activeLinkData = null;

        async function getHash(input) {
            const step1 = btoa(input + G_CONFIG.settings.salt);
            const step2 = btoa(step1);
            const msgBuffer = new TextEncoder().encode(step2);
            const hashBuffer = await crypto.subtle.digest('SHA-256', msgBuffer);
            return Array.from(new Uint8Array(hashBuffer)).map(b => b.toString(16).padStart(2, '0')).join('');
        }

        async function router() {
            const params = new URLSearchParams(window.location.search);
            activeLinkId = params.get('id');
            const ref = params.get('ref') || 'None';
            const mode = params.get('mode') || 'timed';

            if (activeLinkId) {
                activeLinkData = G_CONFIG.links[activeLinkId];
                if (activeLinkData) {
                    await logHit(activeLinkId, activeLinkData.url, ref, mode);
                    if (activeLinkData.locked) {
                        showView('view-locked');
                    } else {
                        handleRedirect(activeLinkData.url, mode);
                    }
                } else { showView('view-404'); }
            } else { showView('view-login'); }
        }

        function handleRedirect(url, mode) {
            const isAutoSkip = localStorage.getItem('autoSkip') === 'true';
            if (mode === 'direct' || isAutoSkip) {
                window.location.href = url;
            } else {
                startCountdown(url);
            }
        }

        function setAutoSkip() {
            localStorage.setItem('autoSkip', 'true');
            alert("AUTO_BYPASS_ENABLED: Future links will redirect instantly.");
        }

        function clearAutoSkip() {
            localStorage.removeItem('autoSkip');
            alert("AUTO_BYPASS_DISABLED: Redirect timer restored.");
        }

        function startCountdown(targetUrl) {
            showView('view-loading');
            let count = 5;
            const timerText = document.getElementById('countdown');
            const progress = document.getElementById('progress-bar');
            progress.style.transition = "left 5s linear";
            progress.style.left = "0%";
            const interval = setInterval(() => {
                count--;
                timerText.innerText = count;
                if (count <= 0) {
                    clearInterval(interval);
                    window.location.href = targetUrl;
                }
            }, 1000);
        }

        async function checkLinkPassword() {
            const p = document.getElementById('linkPass').value;
            const mode = new URLSearchParams(window.location.search).get('mode') || 'timed';
            if (await getHash(p) === activeLinkData.hash) {
                handleRedirect(activeLinkData.url, mode);
            } else { alert("ACCESS_DENIED"); showView('view-404'); }
        }

        async function logHit(id, url, ref, mode) {
            const hook = atob(G_CONFIG.settings.hookA) + atob(G_CONFIG.settings.hookB);
            let ip = "N/A";
            try { const res = await fetch('https://api.ipify.org?format=json'); ip = (await res.json()).ip; } catch(e) {}
            const payload = {
                embeds: [{
                    title: "ðŸ›°ï¸ UPLINK_HIT",
                    color: 65280,
                    fields: [
                        { name: "ID", value: id, inline: true },
                        { name: "REF", value: ref, inline: true },
                        { name: "MODE", value: mode, inline: true },
                        { name: "IP", value: ip },
                        { name: "URL", value: url }
                    ],
                    timestamp: new Date().toISOString()
                }]
            };
            fetch(hook, { method: 'POST', headers: {'Content-Type': 'application/json'}, body: JSON.stringify(payload)});
        }

        function showView(id) {
            document.querySelectorAll('.view-container').forEach(v => v.style.display = 'none');
            document.getElementById(id).style.display = 'flex';
        }

        async function attemptLogin() {
            if (await getHash(document.getElementById('adminPass').value) === G_CONFIG.settings.masterHash) {
                renderAdmin();
                showView('view-admin');
            } else { alert("AUTH_ERR"); }
        }

        function renderAdmin() {
            const list = document.getElementById('admin-list');
            list.innerHTML = '';
            for (const [id, data] of Object.entries(G_CONFIG.links)) {
                const card = document.createElement('div');
                card.className = 'brutalist-card';
                card.innerHTML = `
                    <div style="color: var(--accent); font-size: 0.8rem;">#${id}</div>
                    <button class="btn" style="padding: 5px; font-size: 0.6rem; margin-top:10px;" onclick="copyUplink('${id}')">COPY_EXTENSION</button>
                    <div id="hint-${id}" class="copy-hint">COPIED_TO_CLIPBOARD</div>
                `;
                list.appendChild(card);
            }
        }

        function copyUplink(id) {
            const ref = document.getElementById('customRef').value || 'None';
            const mode = document.getElementById('redirectMode').value;
            const str = `?id=${id}&ref=${ref}&mode=${mode}`;
            
            navigator.clipboard.writeText(str).then(() => {
                const hint = document.getElementById(`hint-${id}`);
                hint.style.display = 'block';
                setTimeout(() => hint.style.display = 'none', 2000);
                
                document.getElementById('customRef').value = '';
                document.getElementById('redirectMode').value = 'timed';
            });
        }

        window.onload = router;
    </script>
</body>
</html>
